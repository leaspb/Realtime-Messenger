# Требования

## Функциональные требования

1. Система должна позволять пользователю ввести имя и `roomId` на стартовой странице.
2. Система должна подключать клиента к WebSocket серверу и выполнять событие `join`.
3. Система должна отображать список активных пользователей комнаты.
4. Система должна поддерживать отправку и получение текстовых сообщений в комнате.
5. Система должна поддерживать WebRTC сигналинг (`offer`, `answer`, `candidate`) для голосовой связи.
6. Система должна позволять включать и выключать микрофон (mute/unmute).
7. Система должна корректно уведомлять о входе/выходе пользователей (`user_joined`, `user_left`).
8. Система должна предоставлять endpoint `GET /api/health` для проверки доступности.

## Нефункциональные требования

1. Приложение должно работать в актуальных браузерах с поддержкой WebRTC.
2. Интерфейс должен быть адаптивным (desktop/mobile).
3. Время отклика на отправку сообщения должно быть близко к реальному времени в пределах стабильной сети.
4. Приложение должно запускаться в `development` и `production` режимах.
5. Кодовая база должна быть типизирована (`TypeScript`) и проходить `npm run check`.

## Требования к окружению

- `Node.js 20+`
- `npm 10+`
- `PostgreSQL` (обязателен из-за текущей инициализации `DATABASE_URL`)
- Переменные окружения:
  - `DATABASE_URL` (обязательно)
  - `PORT` (опционально, по умолчанию `5000`)
  - `NODE_ENV` (`development`/`production`)

## Ограничения текущей реализации

1. Идентификация пользователей эфемерная: `userId` генерируется на сервере случайно.
2. Уровень безопасности базовый: нет аутентификации, шифрование соединений зависит от окружения (HTTPS/WSS).
3. Mesh WebRTC плохо масштабируется для больших комнат (рост нагрузки ~O(n^2) по peer-соединениям).
4. Слой хранения сообщений объявлен, но фактически не используется для persistent history.
